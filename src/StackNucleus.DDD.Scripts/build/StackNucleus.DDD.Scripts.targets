<Project>
  <Target Name="CopyBackendScriptsOnce"
          BeforeTargets="PrepareForBuild"
          Condition="'$(DisableCentralScriptCopy)' != 'true'">
    <PropertyGroup>
      <CentralScriptsDestination>$([System.IO.Path]::GetFullPath('$(SolutionDir)../.scripts'))</CentralScriptsDestination>
    </PropertyGroup>

    <ItemGroup>
      <_ScriptFiles Include="$(MSBuildThisFileDirectory)..\\contentFiles\\any\\any\\.scripts\\**\\*.*" />
    </ItemGroup>

    <MakeDir Directories="@(_ScriptFiles->'$(CentralScriptsDestination)\\%(RecursiveDir)')" />

    <Copy SourceFiles="@(_ScriptFiles)"
          DestinationFiles="@(_ScriptFiles->'$(CentralScriptsDestination)\\%(RecursiveDir)%(Filename)%(Extension)')"
          SkipUnchangedFiles="true" />
  </Target>
</Project>